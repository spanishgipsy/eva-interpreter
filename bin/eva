#!/usr/bin/env tsx

'use strict'

import fs from 'fs';
import evaParser from '../src/parser/evaParser.cjs';
import Eva from '../src/eva';

function evalGlobal(src, eva) {
    const exp = evaParser.parse(`(begin ${src})`);
    return eva.eval(exp);
}

function main(argv) {
    const [_node, _env, mode, exp] = argv;

    const eva = new Eva();

    if (mode === '-e') {
        return evalGlobal(exp, eva);
    }

    if (mode === '-f') {
        const src = fs.readFileSync(exp, 'utf-8');
        return evalGlobal(src, eva);
    }
}

main(process.argv);

